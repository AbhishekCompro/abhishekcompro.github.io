<!doctype html>
<html>
<head>
    <script src="https://www.dropbox.com/static/api/dropbox-datastores-1.0-latest.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<center>
    <button id="writeButton">Click to create <code>hello.txt</code> in Dropbox.</button>
</center>

<script>
    var client = new Dropbox.Client({ key: '1k84gx4hf3csrh6' });

    function doHelloWorld() {
        client.writeFile('hello.txt', 'Hello, World!', function (error) {
            if (error) {
                alert('Error: ' + error);
            } else {
                alert('File written successfully!');
            }
        });
    }

    // Try to complete OAuth flow.
    client.authenticate({ interactive: false }, function (error, client) {
        if (error) {
            alert('Error: ' + error);
        }
    });

    if (client.isAuthenticated()) {
        doHelloWorld();
    }

    document.getElementById('writeButton').onclick = function () {
        client.authenticate(function (error, client) {
            if (error) {
                alert('Error: ' + error);
            } else {
                doHelloWorld();
            }
        });
    }
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<script>

    uploadMedia = function(filename, mdata)
    {
        var header = 'OAuth oauth_version="1.0", oauth_signature_method="PLAINTEXT", oauth_consumer_key="'+ '1k84gx4hf3csrh6' + '", oauth_token="' + localStorage.getItem("oauth_token") + '", oauth_signature="' + 'x3jrwc7icterbcr' + '&' + localStorage.getItem("oauth_token_secret")+'"';

        $.ajax({
            type:'POST',
            url: 'https://api-content.dropbox.com/1/files_put/auto/' + filename,
            headers: { 'Authorization': header, 'Content-Type': 'text/plain'},
            dataType: 'html',
            processData: false,
            data: mdata,
            success: function(data) {
                alert(data);
            },
            error: function(jqXHR, textStatus, errorThrown ) {
                alert("Error when uploading file: " + textStatus + " because:" + errorThrown);
            }
        });
    }

    uploadMedia('testfile.txt', 'test content');

</script>
</body>
</html>